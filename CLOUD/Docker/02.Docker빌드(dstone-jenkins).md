[Dstone Document Index](../../Index.md)

# ğŸ³ Dstone Jenkins (CI/CD) Docker ë¹Œë“œ ë° ì‹¤í–‰ ê°€ì´ë“œ

---

## <span style="color:green;">1. ì»¨í…Œì´ë„ˆ êµ¬ì„± ê°œìš”</span>

ë³¸ í”„ë¡œì íŠ¸ëŠ” Docker Composeë¥¼ ì‚¬ìš©í•˜ì—¬ ì•„ë˜ **1ê°œì˜ ì»¨í…Œì´ë„ˆ**ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.

1. **dstone-jenkins** : CI/CD Tool

---

## <span style="color:green;">2. ì‚¬ì „ ì‘ì—…</span>

1. ì‘ì—… ë””ë ‰í† ë¦¬ ê²°ì •
2. í…œí”Œë¦¿ ë³µì‚¬

```text
/workshop
```

---

## <span style="color:green;">3. WSL í˜¸ìŠ¤íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°</span>

```text
/workshop
  â””â”€ /dstone-jenkins                           # <Jenkins>
     â”œâ”€ jenkins_home/                          #   jenkins home
     â”œâ”€ 01.dstone-jenkins-docker.yml           #   ê°œë³„ Docker Compose ë¹Œë“œíŒŒì¼
     â””â”€ 02.dstone-jenkins-docker-reg.sh        #   Docker Hub ë“±ë¡ Shell
```

---

## <span style="color:green;">4. ì‚¬ì „ì‘ì—…</span>

### 4.1 ì‘ì—…ë””ë ‰í† ë¦¬ë¡œ ì´ë™
```bash
cd /workshop
```

### 4.2 ì‚¬ìš©ì ë³€ê²½, íŒŒì¼ê¶Œí•œ ë³€ê²½
```bash
chown -R root:root *
chmod -R 777 *
cdos 
```
- í•˜ìœ„ë””ë ‰í† ë¦¬ê¹Œì§€ dos2unix ì ìš© ëª…ë ¹ ì•Œë¦¬ì•„ìŠ¤
- alias cdos='find . -type f \( -name "*.sh" -o -name "*.sql" -o -name "*.yml" \) -exec dos2unix {} \;')
---

## <span style="color:green;">5. ì‘ì—… ëª…ë ¹ </span>

### 5.1 Docker Compose ì‹¤í–‰

```bash
docker-compose -p dstone -f /workshop/dstone-jenkins/01.dstone-jenkins-docker.yml up -d
```

### 5.2 ë¡œê·¸ í™•ì¸

```bash
docker-compose -p dstone -f /workshop/dstone-jenkins/01.dstone-jenkins-docker.yml logs -f
```

### 5.3 ì¤‘ì§€ ë° ì‚­ì œ(ë³¼ë¥¨ì„ ê·¸ëŒ€ë¡œ ë‘ë ¤ë©´ -v ì˜µì…˜ì„ ì œê±°)

```bash
docker-compose -p dstone -f /workshop/dstone-jenkins/01.dstone-jenkins-docker.yml down -v
```

### 5.4 ì»¨í…Œì´ë„ˆ ì¤‘ì§€

```bash
docker stop dstone-jenkins
```
---

### 5.5 ì»¨í…Œì´ë„ˆ ì‹œì‘

```bash
docker start dstone-jenkins
```
---

## <span style="color:green;">6. Docker Hub ì´ë¯¸ì§€ ë“±ë¡</span>

ê° ì„œë¹„ìŠ¤ë³„ Docker ì´ë¯¸ì§€ë¥¼ Docker Hubì— ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```text
/workshop/dstone-jenkins/02.dstone-jenkins-docker-reg.sh
```

---

## <span style="color:green;">7. Jenkins Application ë“±ë¡</span>

##### ğŸ”¹ dstone-jenkins ì»¨í…Œì´ë„ˆì— í•„ìš”í•œ ê¸°ëŠ¥ ì„¤ì¹˜(ìµœì´ˆì—ë§Œ ì‘ì—…)
   ```text
   - Maven(mvn ëª…ë ¹ì„ ì¸ì‹í•˜ì§€ ëª»í•  ë•Œ)
       # Jenkins ì»¨í…Œì´ë„ˆì— ì ‘ì†
         docker exec -it dstone-jenkins bash
       # Maven í™•ì¸
         mvn -version
       # Maven ì„¤ì¹˜
         apt install -y maven
       # Maven í™•ì¸
         mvn -version
   - Docker-Compose(docker-compose ëª…ë ¹ì„ ì¸ì‹í•˜ì§€ ëª»í•  ë•Œ)
       # Jenkins ì»¨í…Œì´ë„ˆ ì ‘ì†
         docker exec -it dstone-jenkins bash       
       # Docker Compose ìµœì‹  ë²„ì „ ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜
         DOCKER_COMPOSE_VERSION=$(curl -s https://api.github.com/repos/docker/compose/releases/latest | grep 'tag_name' | cut -d'"' -f4)
         curl -L "https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
         chmod +x /usr/local/bin/docker-compose
   ```

##### ğŸ”¹ jenkins ì ‘ì†
   ```text
   http://localhost:5555/jenkins
   ```

##### ğŸ”¹ jenkins ê¸°ë³¸ ì„¤ì • (ìµœì´ˆ 1íšŒ)
   ```text
   - í•„ìˆ˜ í”ŒëŸ¬ê·¸ì¸
      Git
      GitHub
      Pipeline
      Docker Pipeline
      Maven
   - Global Tool Configuration
      JDK: ì»¨í…Œì´ë„ˆ ë‚´ JDK 21 ì´ë¯¸ í¬í•¨ â†’ ì„¤ì • ë¶ˆí•„ìš”
      Git: ê¸°ë³¸ í¬í•¨	 
   - Credentials
      github-credential: YongSoekChoeng/******
      dockerhub-credential: jysn007/******
   ```

##### ğŸ”¹ jenkins ì— dstone-boot êµ¬ì„±
   ```text
   - General
     1. ì˜¤ë˜ëœ ë¹Œë“œ ì‚­ì œ
        - ë¹Œë“œ ì´ë ¥ ìœ ì§€ ê¸°ê°„(ì¼) : 14ì¼
        - ë³´ê´€í•  ìµœëŒ€ê°¯ìˆ˜ : 50
     2. Do not allow concurrent builds	 
        - Triggers
     1. Build periodically
        - H H(8-15)/2 * * 1-5
   - Pipeline
     1. Definition : Pipeline script from SCM
     2. SCM : Git
     3. Repository URL : https://github.com/YongSoekChoeng/dstone-boot.git
     4. Credentials : Credentials
     5. Branch Specifier : */master
     6. Script Path : Jenkinsfile
   ```

##### ğŸ”¹ jenkins ì— dstone-batch êµ¬ì„±
   ```text
   - General
     1. ì˜¤ë˜ëœ ë¹Œë“œ ì‚­ì œ
        - ë¹Œë“œ ì´ë ¥ ìœ ì§€ ê¸°ê°„(ì¼) : 14ì¼
        - ë³´ê´€í•  ìµœëŒ€ê°¯ìˆ˜ : 50
     2. Do not allow concurrent builds	 
        - Triggers
     1. Build periodically
        - H H(8-15)/2 * * 1-5
   - Pipeline
     1. Definition : Pipeline script from SCM
     2. SCM : Git
     3. Repository URL : https://github.com/YongSoekChoeng/dstone-batch.git
     4. Credentials : Credentials
     5. Branch Specifier : */main
     6. Script Path : Jenkinsfile
   ```

---

